<?php /* Single file with staff extras */ ?>
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>หน้าหลัก</title>
  <style>
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:"Segoe UI",Tahoma,Arial,sans-serif;color:#222;background:#f5f7fb}
    .topbar{height:64px;background:#ffffffcc;backdrop-filter:blur(6px);border-bottom:1px solid #e8ecf5;display:flex;align-items:center;gap:12px;padding:0 16px}
    .brand{font-weight:700;letter-spacing:.3px;color:#1e4dd8}
    .selector,.search,.actions{display:flex;align-items:center;gap:8px}
    .selector select,.search input,.search select,.year-select{height:36px;border:1px solid #d9e0ef;border-radius:10px;padding:0 10px;background:#fff}
    .search{flex:1}.search input{flex:1}
    .hero{min-height:calc(100vh - 64px);background:linear-gradient(#e9f1ff,#cfe2ff,#c6dbff);display:flex;align-items:center;justify-content:center;padding:32px 16px}
    .menu-grid{display:grid;grid-template-columns:repeat(4,minmax(120px,180px));gap:24px;justify-content:center;width:100%;max-width:980px}
    .menu-card{background:#fff;border:1px solid #e6edff;border-radius:22px;padding:22px 16px;display:flex;flex-direction:column;align-items:center;gap:12px;box-shadow:0 6px 18px rgba(30,77,216,.08);transition:transform .18s ease,box-shadow .18s ease;text-decoration:none;color:inherit}
    .menu-card:hover{transform:translateY(-3px);box-shadow:0 10px 22px rgba(30,77,216,.12)}
    .menu-icon{width:56px;height:56px;border-radius:14px;display:grid;place-items:center;background:#f2f6ff;border:1px solid #e1e9ff}
    .menu-title{font-weight:600}.menu-sub{font-size:13px;color:#667}
    .staff-btn{margin-top:6px;padding:4px 10px;border:1px solid #ccc;border-radius:8px;background:#fff;font-size:13px;cursor:pointer;display:flex;align-items:center;gap:4px}
    .staff-btn:hover{background:#f3f6ff;border-color:#1e4dd8;color:#1e4dd8}
    @media (max-width:820px){.menu-grid{grid-template-columns:repeat(2,minmax(140px,1fr))}}
    @media (max-width:460px){.menu-grid{grid-template-columns:1fr 1fr;gap:14px}.selector{display:none}}
    .avatar{width:32px;height:32px;border-radius:50%;background:#d9e4ff;display:grid;place-items:center;font-weight:700;color:#2443c1;border:1px solid #c9d6ff}
  </style>
</head>
<body>
<?php
  // -------- Helpers --------
  function icon_svg($name){
    switch($name){
      case 'stack': return '<svg viewBox="0 0 24 24" width="28" height="28"><path fill="currentColor" d="M12 2 1 7l11 5 11-5-11-5Zm0 7L1 14l11 5 11-5-11-5Zm0 7L1 21l11 5 11-5-11-5Z"/></svg>';
      case 'folder':return '<svg viewBox="0 0 24 24" width="28" height="28"><path fill="currentColor" d="M10 4l2 2h8a2 2 0 0 1 2 2v9a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h5z"/></svg>';
      case 'note':  return '<svg viewBox="0 0 24 24" width="28" height="28"><path fill="currentColor" d="M6 2h12a2 2 0 0 1 2 2v12l-6 6H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm2 4v2h8V6H8zm0 4v2h8v-2H8zm0 4v2h5v-2H8z"/></svg>';
      case 'menu':  return '<svg viewBox="0 0 24 24" width="28" height="28"><path fill="currentColor" d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"/></svg>';
      default: return '';
    }
  }
  function menu_item($href,$title,$sub,$icon,$isStaff=false){
    echo '<div class="menu-card">
            <div class="menu-icon"><span style="color:#2443c1">'.icon_svg($icon).'</span></div>
            <div class="menu-title">'.htmlspecialchars($title).'</div>'.
            ($sub ? '<div class="menu-sub">'.htmlspecialchars($sub).'</div>' : '');
    if($isStaff){
      echo '<button class="staff-btn">▶ แก้ไข</button>';
    }
    echo '</div>';
  }
  function render_header($roleLabel,$role){
    ?>
    <header class="topbar">
      <div class="brand">โลโก้</div>
      <div class="selector">
        <form method="get" id="roleForm">
          <select name="role" onchange="document.getElementById('roleForm').submit()">
            <option value="student"  <?= $role==='student'?'selected':'' ?>>นักศึกษา</option>
            <option value="lecturer" <?= $role==='lecturer'?'selected':'' ?>>อาจารย์</option>
            <option value="staff"    <?= $role==='staff'?'selected':'' ?>>เจ้าหน้าที่</option>
          </select>
        </form>
      </div>
      <div class="search" role="search">
        <input type="text" placeholder="ค้นหา..." />
        <select>
          <option>ทั้งหมด</option>
          <option>เอกสาร</option>
          <option>บทความ</option>
          <option>ผู้แต่ง</option>
        </select>
      </div>
      <div class="actions">
        <?php if($role==='staff'){ ?>
          <select class="year-select">
            <option>2568</option>
            <option>--2567--</option>
            <option>--2566--</option>
            <option>--2565--</option>
            <option>--2564--</option>
          </select>
        <?php } ?>
        <span style="color:#667">สวัสดี, <?= htmlspecialchars($roleLabel) ?></span>
        <div class="avatar" title="โปรไฟล์">U</div>
      </div>
    </header>
    <?php
  }

  // -------- Role routing --------
  $role = isset($_GET['role']) ? strtolower($_GET['role']) : 'student';
  if (!in_array($role, ['student','lecturer','staff'])) $role = 'student';
  $label = ['student'=>'นักศึกษา','lecturer'=>'อาจารย์','staff'=>'เจ้าหน้าที่'][$role];
  render_header($label,$role);
?>
<section class="hero">
  <div class="menu-grid">
    <?php
      if ($role === 'student') {
        menu_item("#search","ค้นหา","เอกสาร/บทความ","stack");
        menu_item("#collect","รวบรวม","ชั้นเก็บของฉัน","folder");
        menu_item("#notes","บันทึก","ร่าง & บันทึกย่อ","note");
        menu_item("#more","อื่นๆ","ตั้งค่า/เมนู","menu");
      } elseif ($role === 'lecturer') {
        menu_item("#search","ค้นหา","เอกสาร/บทความ","stack");
        menu_item("#manage","รวบรวม","คลังบทความสังกัด","folder");
        menu_item("#draft","บันทึก","แบบร่าง & แบบฟอร์ม","note");
        menu_item("#more","อื่นๆ","รายงาน/ตั้งค่า","menu");
      } else { // staff
        menu_item("#search","ตำรา","","stack",true);
        menu_item("#manage","วารสาร","","folder",true);
        menu_item("#docs","บทความ","","note",true);
        menu_item("#more","อื่นๆ","","menu",true);
      }
    ?>
  </div>
</section>
</body>
</html>