<?php
// -------------------------
// ข้อมูลตัวอย่าง (ในงานจริงดึงจากฐานข้อมูล)
// -------------------------
$publications = [
    "ตำรา" => [
        ["title" => "ตำรา AI", "author" => "สมชาย", "year" => 2023],
    ],
    "วารสาร" => [
        ["title" => "วารสารวิจัย IT", "author" => "สมหญิง", "year" => 2022],
    ],
    "บทความ" => [
        ["title" => "บทความ Machine Learning", "author" => "อนันต์", "year" => 2024],
    ],
    "อื่นๆ" => []
];

// -------------------------
// ตรวจสอบ type ที่เลือก
// -------------------------
$type = $_GET['type'] ?? '';
?>
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>ระบบจัดการผลงานตีพิมพ์</title>
    <style>
        body { font-family: Tahoma, sans-serif; margin: 20px; background: #f7f7f7; }
        h1 { text-align: center; }
        .menu { display: flex; gap: 20px; justify-content: center; margin-top: 40px; }
        .menu-item {
            background: #fff;
            padding: 20px;
            text-align: center;
            border-radius: 10px;
            box-shadow: 0 0 8px rgba(0,0,0,0.1);
            width: 150px;
        }
        .menu-item img { width: 64px; height: 64px; }
        .menu-item span { display: block; margin-top: 10px; font-weight: bold; }
        .menu-item .edit-btn { margin-top: 10px; }
        .menu-item .edit-btn a {
            display: inline-block;
            padding: 5px 10px;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 6px;
            text-decoration: none;
            font-size: 13px;
            color: #000;
        }
        .menu-item .edit-btn a:hover {
            background: #007BFF;
            color: #fff;
            border-color: #007BFF;
        }
        .content { margin-top: 40px; max-width: 700px; margin-left: auto; margin-right: auto; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background: #eee; }
        form input, form button { margin-top: 5px; padding: 6px; width: 100%; }
        form button { background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; }
        form button:hover { background: #218838; }
    </style>
</head>
<body>
    <h1>ระบบจัดการผลงานตีพิมพ์</h1>

    <!-- เมนูหลัก -->
    <div class="menu">
        <div class="menu-item">
            <img src="icons/book.png">
            <span>ตำรา</span>
            <div class="edit-btn"><a href="?type=ตำรา">✏️ แก้ไข</a></div>
        </div>
        <div class="menu-item">
            <img src="icons/journal.png">
            <span>วารสาร</span>
            <div class="edit-btn"><a href="?type=วารสาร">✏️ แก้ไข</a></div>
        </div>
        <div class="menu-item">
            <img src="icons/article.png">
            <span>บทความ</span>
            <div class="edit-btn"><a href="?type=บทความ">✏️ แก้ไข</a></div>
        </div>
        <div class="menu-item">
            <img src="icons/more.png">
            <span>อื่นๆ</span>
            <div class="edit-btn"><a href="?type=อื่นๆ">✏️ แก้ไข</a></div>
        </div>
    </div>

    <!-- ส่วนแก้ไข -->
    <?php if ($type): ?>
    <div class="content">
        <h2>แก้ไขข้อมูลหมวด: <?= htmlspecialchars($type) ?></h2>

        <!-- ฟอร์มเพิ่มข้อมูล -->
        <form method="post" action="save_edit.php">
            <label>ชื่อเรื่อง:</label>
            <input type="text" name="title" required>

            <label>ผู้แต่ง:</label>
            <input type="text" name="author" required>

            <label>ปีที่ตีพิมพ์:</label>
            <input type="number" name="pub_year" required>

            <input type="hidden" name="pub_type" value="<?= htmlspecialchars($type) ?>">

            <button type="submit">บันทึก</button>
        </form>

        <!-- ตารางข้อมูล -->
        <table>
            <tr>
                <th>ชื่อเรื่อง</th>
                <th>ผู้แต่ง</th>
                <th>ปี</th>
                <th>จัดการ</th>
            </tr>
            <?php if (!empty($publications[$type])): ?>
                <?php foreach ($publications[$type] as $p): ?>
                <tr>
                    <td><?= htmlspecialchars($p["title"]) ?></td>
                    <td><?= htmlspecialchars($p["author"]) ?></td>
                    <td><?= htmlspecialchars($p["year"]) ?></td>
                    <td>
                        <a href="edit_item.php?id=1">แก้ไข</a> | 
                        <a href="delete_item.php?id=1">ลบ</a>
                    </td>
                </tr>
                <?php endforeach; ?>
            <?php else: ?>
                <tr><td colspan="4" style="text-align:center;">ยังไม่มีข้อมูล</td></tr>
            <?php endif; ?>
        </table>
    </div>
    <?php endif; ?>
</body>
</html>
